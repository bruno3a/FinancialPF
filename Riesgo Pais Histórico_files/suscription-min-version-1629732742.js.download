window.TDUser=new TDUserClass();window.TDUser.init({'trackerDaysAgo':30,'trackerContentLimit':100000,'limitShowWallClosed':100000,'showLog':!0,'apiUserBaseUrl':jq('script[data-apiUserBaseUrl]').attr("data-apiUserBaseUrl"),'enabledCache':!1});localStorage.setItem("apiUserBaseUrl",TDUser.options.apiUserBaseUrl);function SHA1(msg){function rotate_left(n,s){var t4=(n<<s)|(n>>>(32-s));return t4};function lsb_hex(val){var str='';var i;var vh;var vl;for(i=0;i<=6;i+=2){vh=(val>>>(i*4+4))&0x0f;vl=(val>>>(i*4))&0x0f;str+=vh.toString(16)+vl.toString(16)}
return str};function cvt_hex(val){var str='';var i;var v;for(i=7;i>=0;i--){v=(val>>>(i*4))&0x0f;str+=v.toString(16)}
return str};function Utf8Encode(string){string=string.replace(/\\r\\n/g,'\n');var utftext='';for(var n=0;n<string.length;n++){var c=string.charCodeAt(n);if(c<128){utftext+=String.fromCharCode(c)}
else if((c>127)&&(c<2048)){utftext+=String.fromCharCode((c>>6)|192);utftext+=String.fromCharCode((c&63)|128)}
else{utftext+=String.fromCharCode((c>>12)|224);utftext+=String.fromCharCode(((c>>6)&63)|128);utftext+=String.fromCharCode((c&63)|128)}}
return utftext};var blockstart;var i,j;var W=new Array(80);var H0=0x67452301;var H1=0xEFCDAB89;var H2=0x98BADCFE;var H3=0x10325476;var H4=0xC3D2E1F0;var A,B,C,D,E;var temp;msg=Utf8Encode(msg);var msg_len=msg.length;var word_array=new Array();for(i=0;i<msg_len-3;i+=4){j=msg.charCodeAt(i)<<24|msg.charCodeAt(i+1)<<16|msg.charCodeAt(i+2)<<8|msg.charCodeAt(i+3);word_array.push(j)}
switch(msg_len%4){case 0:i=0x080000000;break;case 1:i=msg.charCodeAt(msg_len-1)<<24|0x0800000;break;case 2:i=msg.charCodeAt(msg_len-2)<<24|msg.charCodeAt(msg_len-1)<<16|0x08000;break;case 3:i=msg.charCodeAt(msg_len-3)<<24|msg.charCodeAt(msg_len-2)<<16|msg.charCodeAt(msg_len-1)<<8|0x80;break}
word_array.push(i);while((word_array.length%16)!=14)word_array.push(0);word_array.push(msg_len>>>29);word_array.push((msg_len<<3)&0x0ffffffff);for(blockstart=0;blockstart<word_array.length;blockstart+=16){for(i=0;i<16;i++)W[i]=word_array[blockstart+i];for(i=16;i<=79;i++)W[i]=rotate_left(W[i-3]^W[i-8]^W[i-14]^W[i-16],1);A=H0;B=H1;C=H2;D=H3;E=H4;for(i=0;i<=19;i++){temp=(rotate_left(A,5)+((B&C)|(~B&D))+E+W[i]+0x5A827999)&0x0ffffffff;E=D;D=C;C=rotate_left(B,30);B=A;A=temp}
for(i=20;i<=39;i++){temp=(rotate_left(A,5)+(B^C^D)+E+W[i]+0x6ED9EBA1)&0x0ffffffff;E=D;D=C;C=rotate_left(B,30);B=A;A=temp}
for(i=40;i<=59;i++){temp=(rotate_left(A,5)+((B&C)|(B&D)|(C&D))+E+W[i]+0x8F1BBCDC)&0x0ffffffff;E=D;D=C;C=rotate_left(B,30);B=A;A=temp}
for(i=60;i<=79;i++){temp=(rotate_left(A,5)+(B^C^D)+E+W[i]+0xCA62C1D6)&0x0ffffffff;E=D;D=C;C=rotate_left(B,30);B=A;A=temp}
H0=(H0+A)&0x0ffffffff;H1=(H1+B)&0x0ffffffff;H2=(H2+C)&0x0ffffffff;H3=(H3+D)&0x0ffffffff;H4=(H4+E)&0x0ffffffff}
var temp=cvt_hex(H0)+cvt_hex(H1)+cvt_hex(H2)+cvt_hex(H3)+cvt_hex(H4);return temp.toLowerCase()}
function setCookieEmailHash(value){var sd=window.location.host;var sdSplit=sd.split('.');sd='.'+sdSplit[1]+'.'+sdSplit[2];if(value!=""){jq.cookie("TDEmailHash",SHA1(decodeURIComponent(value)),{path:'/',expires:1});jq.cookie("TDEmailHash",SHA1(decodeURIComponent(value)),{path:'/',domain:sd,expires:1})}else{jq.cookie("TDEmailHash","empty",{path:'/',expires:1});jq.cookie("TDEmailHash","empty",{path:'/',domain:sd,expires:1})}}
TDUser.validateSubscribedMP=function(notSubscribed,subscribed){if(this.options.enabledCache){var isSuscripted=jq.cookie("TDsubscribed");if(isSuscripted){TDUser.log("Usuario suscripto");subscribed.call();return!1}}
if(this.options.enabledCache){var email=jq.cookie("TDEmail");if(!email){TDUser.log("Usuario no registrado");notSubscribed.call(this,!1);return!1}
TDUser.addSubscribedMP(email,notSubscribed,subscribed)}else{let url=TDUser.options.apiUserBaseUrl+"/user";var jqxhr=jq.ajax({type:"GET",url:url,xhrFields:{withCredentials:!0}}).done(function(response){TDUser.log("Si es un usuario logueado agregamos la suscripcion");jq('.subscribe-btn.reload-login').hide();TDUser.addSubscribedMP(response.email,notSubscribed,subscribed)}).fail(function(response){if(typeof(response.status)!="undefined"&&response.status==404){console.log("FAIL - response.status: "+response.status);TDUser.removeCookies();jq(".TDuserNotLogued").show();jq(".TDuserLogued").hide()}else{console.log("FAIL - else - response.status: "+response.status)}
TDUser.log("Usuario no registrado");notSubscribed.call(this,!1);return!1})}};jq('.mercadopago-btn:not(.mobile-header-login)').click(function(){window.location="/contenidos/suscripcion.html"});jq('.button-mp').click(function(ev){var urlRedirect=jq(this).attr('data-href');console.log("Definimos la siguiente url para redireccionar => ",urlRedirect);window.redirectMp=function(){window.location=urlRedirect}
TDUser.validateSubscribedMP(function(isLogged){if(!isLogged){window.TDUser.addEvent("onUserLogin",window.redirectMp);window.TDUser.addEvent("onRegistrationFinish",window.redirectMp);window.TDUser.openSignwall();return!1}else{window.redirectMp()}})});jq('.subscribe-btn.reload-login').click(function(ev){email=jq.cookie("TDEmail");if(jq(this).hasClass("has-subscription")&&email){var emailEncoded=btoa(email);jq("#email-subscription-external").val(emailEncoded);jq("#printed-edition-external").submit();return!1}
window.reloadPage=function(){window.location.reload()}
window.TDUser.addEvent("onUserLogin",window.reloadPage);window.TDUser.addEvent("onRegistrationFinish",window.reloadPage);window.TDUser.openSignwall()});jq('.register-btn.reload-login').click(function(ev){window.reloadPage=function(){window.location.reload()}
window.TDUser.addEvent("onUserLogin",window.reloadPage);window.TDUser.addEvent("onRegistrationFinish",window.reloadPage);window.TDUser.openRegisterSignwall()});if(jq('.content-protected-true').length>0||jq('.view-printed-edition').length>0){console.log("Tenemos contenido protegido, validamos si es un usuario suscripto");TDUser.validateSubscribedMP(function(isLogged){console.log("Implementado logica para usuario no suscripto");jq('.content-protected-true').remove();jq('.suscription-true').show();jq.cookie("TDUrlRedirect",window.location.href,{path:'/',expires:1})},function(isLogged){console.log("El usuario esta suscripto removemos los bloqueadores");jq('.content-protected-true').removeClass('content-protected-true');jq('.suscription-exclusive').addClass('content-protected-true');if(jq('.pdf-container').length>0){var fecha='';if(jq('section.suscription-download').data('date')){fecha=jq('section.suscription-download').data('date')}
jq.ajax({url:"/resources/_post/ambito/getPdf.php?email="+jq.cookie("TDEmail")+"&fecha="+fecha,dataType:"json"}).done(function(data){if(data.pages.length){jq('#pdf-container').data('pages',data.pages)}else{jq('#pdf-container').attr('data-file',data.urlPdf)}
jq('#pdf-high').attr('href',data.urlPdf);if(jq('#pdf-high').length&&!CMSTools.isCMSBackend){var urlTest=data.urlPdf;var patt=new RegExp("diario.ambito.com");var res=patt.test(urlTest);if(res){console.log("P1");var email=jq.cookie("TDEmail");var emailEncoded=btoa(email);if(jq('.view-printed-edition').length>0){console.log("P2");jq('.view-printed-edition a').click(function(){console.log("P3");jq("#email-subscription-external").val(emailEncoded);jq("#printed-edition-external").submit();return!1})}else{jq("#email-subscription-external").val(emailEncoded);jq("#printed-edition-external").submit()}
console.log("TD-3")}else{if(jq('.view-printed-edition').length>0){jq('.view-printed-edition a').each(function(){jq(this).attr("href",data.urlPdf);jq(this).attr("target","_blank")})}else{window.location.href=data.urlPdf}
console.log("TD-4")}}})}})}else{function loadPDF(){if(typeof(pdfReader)=="undefined"){setTimeout(loadPDF,1000);return!1}
var fecha='';if(jq('section.suscription-download').data('date')){fecha=jq('section.suscription-download').data('date')}
jq.ajax({url:"/resources/_post/ambito/getPdf.php?instance="+Math.random()+"&fecha="+fecha,dataType:"json"}).done(function(data){if(data.pages.length){jq('#pdf-container').data('pages',data.pages)}else{jq('#pdf-container').attr('data-file',data.urlPdf)}
jq('#pdf-high').attr('href',data.urlPdf);if(jq('#pdf-high').length&&!CMSTools.isCMSBackend)
var urlTest=data.urlPdf;var patt=new RegExp("diario.ambito.com");var res=patt.test(urlTest);if(res){var email=jq.cookie("TDEmail");var emailEncoded=btoa(email);$("#email-subscription-external").val(emailEncoded);$("#printed-edition-external").submit();console.log("TD-1")}else{window.location.href=data.urlPdf;console.log("TD-2")}})}
if(jq('.content-protected-false.pdf-container').length>0){loadPDF()}}
function waitPDF(){if(typeof(pdfReader)=="undefined"){setTimeout(waitPDF,1000);return!1}else{pdfReader()}}
var vars=[],hash;var hashes=window.location.href.slice(window.location.href.indexOf('?')+1).split('&');for(var i=0;i<hashes.length;i++){hash=hashes[i].split('=');vars.push(hash[0]);vars[hash[0]]=hash[1]}
if(typeof(vars.preapproval_id)!='undefined'){window.TDUser.payId=vars.preapproval_id;window.TDUser.payMethod="mercadopago";window.TDUser.addEvent("onRegistrationFinish",function(){var urlRedirect='/contenidos/suscripcion-ok.html';console.log('urlRedirect:');console.log(urlRedirect);if(urlRedirect&&urlRedirect!="undefiend"){window.location=urlRedirect}});window.TDUser.addSuscription()}
function pushAnalytics(){var script=document.createElement("script");script.src='https://www.googletagmanager.com/gtag/js?id=G-0F6QJH2EL4';script.async=!0;document.head.appendChild(script);var s=document.createElement('script');s.type='text/javascript';var code='window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag("js", new Date()); gtag("config", "G-0F6QJH2EL4"); gtag("send", "pageview", location.pathname);';try{s.appendChild(document.createTextNode(code));document.body.appendChild(s)}catch(e){s.text=code;document.body.appendChild(s)}}
function inIframe(){try{return window.self!==window.top}catch(e){return!0}}
window.TDUser.addEvent("ExceededReadingLimits",function(){if(!inIframe()){pushAnalytics();jq('#notes-read-limit-message').show();jq('.container.note').hide();jq("#banner-suscripcion").show();jq("body").addClass("with-banner-suscripcion");$body=jq("body");$bs=jq("#banner-suscripcion");bsHeight=$bs.outerHeight(!0);$body.css('padding-bottom',bsHeight+'px');jq($bs).prependTo("body")}});window.TDUser.addEvent("onUserLogin",function(){window.location.reload()});window.TDUser.addEvent("onLogout",function(){window.location.href='/'});if(window.location.hash.indexOf("openLogin")>0){jq(window).on("load",function(){window.reloadPageHash=function(){window.location=document.referrer}
window.TDUser.addEvent("onUserLogin",window.reloadPageHash);window.TDUser.addEvent("onRegistrationFinish",window.reloadPageHash);window.TDUser.openSignwall()})}
if(window.location.hash.indexOf("openRegistro")>0){jq(window).on("load",function(){window.reloadPageHash=function(){window.location=window.location.pathname}
window.TDUser.addEvent("onUserLogin",window.reloadPageHash);window.TDUser.addEvent("onRegistrationFinish",window.reloadPageHash);window.TDUser.openRegisterSignwall()})}
function getCookieByName(name){var v=document.cookie.match('(^|;) ?'+name+'=([^;]*)(;|$)');return v?v[2]:null};var email=getCookieByName('TDEmail');if(email!=""&&email!="undefined"&&email!=undefined){localStorage.setItem("TDEmail",email);setCookieEmailHash(email)}else{localStorage.removeItem("TDEmail");setCookieEmailHash("")}